<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHYRED - Video Hub</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="video-styles.css">
    <!-- Boxicons CDN -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>
    <div class="container">
        <!-- Background Effects -->
        <div class="background-gradient"></div>
        <div class="particles-container" id="particles"></div>

        <!-- Navigation -->
        <nav class="navigation">
            <div class="nav-content">
                <div class="logo">SHYRED</div>
                <div class="nav-links">
                    <a href="index.html" class="nav-link">HOME</a>
                    <a href="video.html" class="nav-link active">VIDEO</a>
                    <a href="marketplace.html" class="nav-link">MARKETPLACE</a>
                    <a href="chatting.html" class="nav-link">CHATTING</a>
                </div>
                <div class="nav-user">
                    <a href="profile.html" class="user-avatar-link" id="userAvatarLink" title="Đi tới Profile">
                        <img class="nav-user-avatar" id="navUserAvatar" src="" alt="User Avatar">
                        <span class="user-name" id="navUserName">User</span>
                    </a>
                </div>
            </div>
        </nav>

        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-content">
                <div class="sidebar-letter">B</div>
                <div class="sidebar-letter">I</div>
                <div class="sidebar-letter">L</div>
                <div class="sidebar-letter">E</div>
                <div class="sidebar-letter">R</div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="video-main-content">
            <!-- Video Upload Section -->
            <div class="upload-section">
                <div class="upload-header">
                    <h1 class="page-title">MEDIA HUB</h1>
                    <div class="upload-buttons">
                        <button class="btn btn-primary upload-btn" id="showVideoForm">
                            <i class='bx bx-video upload-icon'></i>
                            ADD VIDEO
                        </button>
                        <button class="btn btn-secondary upload-btn" id="showImageForm">
                            <i class='bx bx-image upload-icon'></i>
                            ADD IMAGE
                        </button>
                    </div>
                </div>

                <!-- Video Upload Form -->
                <div class="upload-form" id="videoUploadForm">
                    <div class="form-container">
                        <h3>Upload New Video</h3>
                        <form id="videoForm">
                            <div class="form-group">
                                <label for="videoFile">Video File:</label>
                                <input type="file" id="videoFile" accept="video/*" required>
                                <div class="file-input-custom">
                                    <span class="file-text">Choose video file...</span>
                                    <span class="file-btn">Browse</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="videoTitle">Video Title:</label>
                                <input type="text" id="videoTitle" placeholder="Enter video title..." required>
                            </div>

                            <div class="form-group">
                                <label for="videoDescription">Description (Optional):</label>
                                <textarea id="videoDescription" placeholder="Describe your video..."></textarea>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">UPLOAD VIDEO</button>
                                <button type="button" class="btn btn-secondary" id="cancelVideoUpload">CANCEL</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Image Upload Form -->
                <div class="upload-form" id="imageUploadForm" style="display: none;">
                    <div class="form-container">
                        <h3>Upload New Image</h3>
                        <form id="imageForm">
                            <div class="form-group">
                                <label for="imageFile">Image File:</label>
                                <input type="file" id="imageFile" accept="image/*" required>
                                <div class="file-input-custom">
                                    <span class="file-text">Choose image file...</span>
                                    <span class="file-btn">Browse</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="imageTitle">Image Title:</label>
                                <input type="text" id="imageTitle" placeholder="Enter image title..." required>
                            </div>

                            <div class="form-group">
                                <label for="imageDescription">Description (Optional):</label>
                                <textarea id="imageDescription" placeholder="Describe your image..."></textarea>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">UPLOAD IMAGE</button>
                                <button type="button" class="btn btn-secondary" id="cancelImageUpload">CANCEL</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Video List Section -->
            <div class="video-list-section">
                <!-- Search and Filter -->
                <div class="search-filter-section">
                    <div class="search-wrapper">
                        <i class='bx bx-search search-icon'></i>
                        <input type="text" class="search-input" id="searchInput" placeholder="Search videos...">
                    </div>
                    <div class="filter-buttons">
                        <button class="filter-btn active" data-filter="all">
                            <i class='bx bx-folder filter-icon'></i>
                            All
                        </button>
                        <button class="filter-btn" data-filter="favorites">
                            <i class='bx bx-heart filter-icon'></i>
                            Favorites
                        </button>
                    </div>
                </div>

                <!-- Bulk Actions -->
                <div class="bulk-actions" id="bulkActions">
                    <div class="bulk-info">
                        <span id="selectedCount">0</span> videos selected
                    </div>
                    <div class="bulk-buttons">
                        <button class="bulk-btn" id="bulkFavorite">Add to Favorites</button>
                        <button class="bulk-btn" id="bulkUnfavorite">Remove from Favorites</button>
                        <button class="bulk-btn danger" id="bulkDelete">Delete Selected</button>
                        <button class="bulk-btn" id="cancelBulk">Cancel</button>
                    </div>
                </div>

                <!-- Sort Controls -->
                <div class="sort-controls">
                    <div class="sort-options">
                        <span class="sort-label">Sort by:</span>
                        <button class="sort-btn active" data-sort="newest">Newest First</button>
                        <button class="sort-btn" data-sort="oldest">Oldest First</button>
                        <button class="sort-btn" data-sort="title">A-Z</button>
                        <button class="sort-btn" data-sort="favorites">Favorites First</button>
                    </div>
                    <div class="video-count">
                        <span id="videoCount">0 videos</span>
                    </div>
                </div>

                <!-- Video Grid -->
                <div class="video-grid" id="videoGrid">
                    <!-- Videos will be dynamically added here -->
                </div>

                <!-- Empty State -->
                <div class="empty-state" id="emptyState">
                    <div class="empty-icon"><i class='bx bx-video'></i></div>
                    <h3>No videos yet</h3>
                    <p>Start by uploading your first video to the SHYRED hub</p>
                    <button class="btn btn-primary" onclick="document.getElementById('showUploadForm').click()">
                        UPLOAD FIRST VIDEO
                    </button>
                </div>
            </div>
        </div>

        <!-- Video Player Modal -->
        <div class="video-modal" id="videoModal">
            <div class="modal-content">
                <button class="close-modal" id="closeModal"><i class='bx bx-x'></i></button>
                <video controls class="modal-video" id="modalVideo">
                    Your browser does not support the video tag.
                </video>
                <div class="modal-info">
                    <div class="modal-header">
                        <div class="modal-avatar">
                            <img id="modalAvatar" src="" alt="User Avatar">
                        </div>
                        <div class="modal-details">
                            <h3 id="modalTitle"></h3>
                            <p id="modalDate"></p>
                        </div>
                    </div>
                    <p id="modalDescription"></p>
                </div>
            </div>
        </div>

        <!-- Edit Video Modal -->
        <div class="edit-modal" id="editModal">
            <div class="edit-modal-content">
                <div class="edit-modal-header">
                    <h3 class="edit-modal-title">Edit Video</h3>
                    <button class="close-modal" id="closeEditModal"><i class='bx bx-x'></i></button>
                </div>
                <div class="edit-modal-body">
                    <form id="editVideoForm">
                        <div class="form-group">
                            <label for="editVideoTitle">Video Title:</label>
                            <input type="text" id="editVideoTitle" required>
                        </div>

                        <div class="form-group">
                            <label for="editVideoDescription">Description:</label>
                            <textarea id="editVideoDescription" placeholder="Describe your video..."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="editUserAvatar">Change Avatar:</label>
                            <input type="file" id="editUserAvatar" accept="image/*">
                            <div class="file-input-custom">
                                <span class="file-text">Choose new avatar image...</span>
                                <span class="file-btn">Browse</span>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">SAVE CHANGES</button>
                            <button type="button" class="btn btn-secondary" id="cancelEdit">CANCEL</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Confirmation Dialog -->
        <div class="confirmation-dialog" id="confirmationDialog">
            <div class="confirmation-content">
                <div class="confirmation-icon"><i class='bx bx-error-circle'></i></div>
                <h3 class="confirmation-title" id="confirmationTitle">Confirm Action</h3>
                <p class="confirmation-message" id="confirmationMessage">Are you sure you want to proceed?</p>
                <div class="confirmation-actions">
                    <button class="btn btn-danger" id="confirmAction">YES, DELETE</button>
                    <button class="btn btn-secondary" id="cancelAction">CANCEL</button>
                </div>
            </div>
        </div>

        <!-- Additional glow effects -->
        <div class="glow-effect glow-purple"></div>
        <div class="glow-effect glow-blue"></div>
    </div>

    <script src="script.js"></script>
    <script>
        // Check authentication before loading video features
        function checkAuthentication() {
            const currentUser = JSON.parse(localStorage.getItem('shyred_current_user') || 'null');
            if (!currentUser) {
                // Redirect to login with return URL
                alert('Bạn cần đăng nhập để truy cập trang VIDEO!');
                window.location.href = 'login.html?returnUrl=' + encodeURIComponent(window.location.href);
                return false;
            }
            return true;
        }

        // Initialize user avatar navigation
        function initUserAvatar() {
            const currentUser = JSON.parse(localStorage.getItem('shyred_current_user') || 'null');
            const navUserAvatar = document.getElementById('navUserAvatar');
            const navUserName = document.getElementById('navUserName');
            const userAvatarLink = document.getElementById('userAvatarLink');

            if (currentUser && navUserAvatar && navUserName) {
                navUserAvatar.src = currentUser.avatar || getDefaultAvatar();
                navUserName.textContent = currentUser.username;
                userAvatarLink.style.display = 'flex';
            } else if (userAvatarLink) {
                userAvatarLink.style.display = 'none';
            }
        }

        function getDefaultAvatar() {
            return 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9InVybCgjZ3JhZGllbnQwKSIvPgo8Y2lyY2xlIGN4PSIyMCIgY3k9IjE1IiByPSI2IiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjgiLz4KPHBhdGggZD0iTTMwIDMwQzMwIDI1LjU4MjggMjYuNDE4MyAyMiAyMiAyMkgxMkM3LjU4MTcyIDIyIDQgMjUuNTgyOCA0IDMwVjMwSDMwWiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC44Ii8+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9ImdyYWRpZW50MCIgeDElPSIwIiB5MT0iMCIgeDI9IjQwIiB5Mj0iNDAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iI0I0NDdFQiIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMyQjZDRUUiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4=';
        }

        // Check auth when page loads
        document.addEventListener('DOMContentLoaded', function() {
            if (!checkAuthentication()) {
                return;
            }
            initUserAvatar();
        });
    </script>
    <script src="video-script.js"></script>
    <script>
        // Load and apply saved theme
        function loadSavedTheme() {
            const currentUser = JSON.parse(localStorage.getItem('shyred_current_user') || 'null');
            if (currentUser && currentUser.settings && currentUser.settings.theme) {
                const theme = currentUser.settings.theme;
                applyTheme(theme);
                console.log('Applied saved theme in video page:', theme);
            }
        }

        // Apply theme to page
        function applyTheme(theme) {
            const root = document.documentElement;
            root.style.setProperty('--cyber-purple', theme.primaryColor);
            root.style.setProperty('--cyber-blue', theme.secondaryColor);
            root.style.setProperty('--cyber-pink', theme.accentColor);
            root.style.setProperty('--cyber-glow', theme.primaryColor);

            // Update glow effects manually
            const glowPurple = document.querySelector('.glow-purple');
            const glowBlue = document.querySelector('.glow-blue');

            if (glowPurple) {
                const rgb = hexToRgb(theme.primaryColor);
                glowPurple.style.background = `rgba(${rgb}, 0.1)`;
            }
            if (glowBlue) {
                const rgb = hexToRgb(theme.secondaryColor);
                glowBlue.style.background = `rgba(${rgb}, 0.1)`;
            }
        }

        // Helper function to convert hex to rgb
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ?
                `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` :
                '180, 71, 235';
        }

        // Load theme when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedTheme();
        });
    </script>
</body>
</html>
